function AdLocation(t,a){this.id=t.id,this.name=t.name,this.reload_rate=1e3*t.reload_rate,this.kind=t.kind,this.form_authenticity_token=a,this.is_visual=function(){return"AdLocation::Visual"==this.kind},this.is_sponsored=function(){return"AdLocation::SponsoredLinks"==this.kind},this.is_firm_visual=function(){return"AdLocation::FirmVisual"==this.kind},this.element=function(){return $("#ad_location_"+this.name)},this.reload=function(){var e=this,t=location.search.match(/keywords.+=([^&]+)/);"[object Array]"===Object.prototype.toString.call(t)&&(t=t[1]),$.ajax({url:"/particle/reload/"+this.id,type:"GET",data:{authenticity_token:this.form_authenticity_token,"category_ids[]":this.categories,keywords:decodeURIComponent(t)},success:function(t){if(e.is_visual()){var a=new Campaign(t.campaign);a.ad_location=e,campaigns_controller.show(a)}else e.is_sponsored()&&campaigns_controller.index(t,e)},dataType:"json"})}}function Campaign(t){this.id=t.id,this.public_filename=t.public_filename,this.width=t.width,this.height=t.height,this.link_url=t.link_url,this.announcer=t.announcer,this.commercial_message=t.commercial_message,this.is_image=function(){return-1==this.public_filename.indexOf(".swf")},this.attachment=function(){return this.ad_location.is_visual()?this.public_filename.endsWith(".zip")?this.attachment_for_html():this.attachment_for_visual():this.ad_location.is_sponsored()?"between"==this.ad_location.name?this.attachment_for_visual():this.attachment_for_sponsored():this.ad_location.is_firm_visual()?this.attachment_for_visual():void 0},this.attachment_for_html=function(){var t=this,a=document.createElement("iframe");return a.setAttribute("src","https://lespagesmaghreb.com/particles/"+t.id+"/"),a.setAttribute("scrolling","no"),a.setAttribute("width",t.width),a.setAttribute("height",t.height),a.style.border="none",a},this.attachment_for_visual=function(){var t=this,a=$(document.createElement("a"));return a.attr("href","https://lespagesmaghreb.com/campaigns/"+t.id+"/click"),a.attr("target","_blank"),this.is_image()?(a.append(this.image_attachment()),a):this.flash_placeholder()},this.attachment_for_sponsored=function(){var t=this,a=$(document.createElement("p"));a.addClass("campaign");var e=$(document.createElement("a"));e.attr("target","_blank"),e.attr("href","https://lespagesmaghreb.com/campaigns/"+t.id+"/click"),e.html(this.announcer.usual_corporate_name);var i=$(document.createElement("span"));i.html(this.commercial_message);var n=$(document.createElement("a"));return n.addClass("sponsored_firm_page_link"),n.attr("href","https://lespagesmaghreb.com/firms/"+this.announcer.public_id),n.html("Voir la fiche d\xe9taill\xe9e"),a.append(e).append("<br />").append(i).append(n),a},this.image_attachment=function(){var t=$(document.createElement("img"));return t.attr("alt",this.announcer.usual_corporate_name),t.attr("src","https://lespagesmaghreb.com"+this.public_filename),t},this.flash_placeholder=function(){return $('<div id="campaign_'+this.id+'"></div>')},this.firm_visual_element=function(){return $("#firm_"+this.announcer.public_id+" .campaign.firm_visual")}}var ad_locations_controller={show:function(t){if(t.is_visual()){var a=$(document.createElement("div"));a.addClass("ad_location").addClass(t.name).attr("id","ad_location_"+t.name),a.addClass("visual"),$("script#ad_location_src_"+t.name).after(a);var e=new Campaign(t.campaigns.campaign);e.ad_location=t,campaigns_controller.show(e)}else t.is_sponsored()&&campaigns_controller.index(t.campaigns,t);t.campaigns=null,t.is_visual()&&t.reload_rate&&setInterval(function(){t.reload()},t.reload_rate)}},campaigns_controller={index:function(n,s){if("between"==s.name)ad_location_elements=$(".inbetween"),$.each(ad_location_elements,function(t,a){var e=t%n.length,i=new Campaign(n[e].campaign);i.ad_location=s,a.append(i.attachment()[0])});else{var i=$(document.createElement("div"));i.addClass("ad_location").addClass(s.name).attr("id","ad_location_"+s.name),i.addClass("sponsored"),(i=s.element()).empty(),$.each(n,function(t,a){var e=new Campaign(a.campaign);e.ad_location=s,i.append(e.attachment())})}},show:function(t){if(t.ad_location.is_visual()||t.ad_location.is_sponsored()){var a=t.ad_location.element();a.empty();var e=t.attachment();a.append(e);var i,n={},s={wmode:"transparent"};t.is_image()||swfobject.embedSWF("https://lespagesmaghreb.com"+t.public_filename,e.attr("id"),t.width,t.height,"9.0.0","expressInstall.swf",i,s,n)}else t.ad_location.is_firm_visual()&&(t.firm_visual_element().append(t.attachment()),t.is_image()||swfobject.embedSWF("https://lespagesmaghreb.com"+t.public_filename,"campaign_"+t.id,t.width,t.height,"9.0.0","expressInstall.swf",i,s,n))}};